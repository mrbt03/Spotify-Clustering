
## Load necessary packages and read in Spotify attribute data

```{r}
# Load necessary packages and read in df

library(tidyverse)

library(mclust)

library(psych)

library(cluster)

library(dplyr)

df <- read.csv("/kaggle/input/spotify-data/SpotifyFeatures.csv", header=TRUE)

set.seed(12345)
```

```{r}
# Examine data

head(df)

# Remove duplicated tracks that could result in skewing

df <- df[!duplicated(df$track_id), ]
```


## Preprocess DataFrame

```{r}
# Remove non numerical variables

df_ready_for_pca <- df[, !names(df) %in% c('popularity','genre', 'artist_name', 'track_name', 'track_id', 'key', 'mode', 'time_signature')]



# Examine Data

head(df_ready_for_pca)
```


Since the units are incommensurate, we choose to standardize the dataset to variables with large variances (such as duration_ms and tempo) do not dominate

```{r}
data_scaled <- scale(df_ready_for_pca)
```


## Determine number of principal components


First, I will observe the scree plot of the correlation matrix of the standarize data and use the elbow method to identify the number of components. 

```{r}
# Plot PCA results

scree(cor(data_scaled), factors=FALSE)
```


Kaiser Criterion suggests 3 factors, but since component 4 has a eigenvalue close to 1, we will investigate it aswellBased on this, it seems we will need 3 components. Furthermore, utilizing the Kaiser Criterion, we can see that 3 components have eigenvalues greater than 1, suggesting we will need 3 components. However, since the four component has an eigenvalue close to 1, I will also investigate it to see if the loadings are better.


#### 1 Factor

```{r}
# 1 factor: 

fa_result <- factanal(data_scaled, factors = 1, rotation = "varimax")

print(fa_result, cutoff=0.3, digits=3, sort=TRUE)



pca_result <- principal(data_scaled, nfactors=1, rotate="varimax")

print(pca_result$loadings, cutoff=0.4, digits=3, sort=TRUE)



# For correlation

model2 <- principal(data_scaled, nfactors = 1, rotate = 'promax')



# Correlation for promax

cor(model2$scores)
```


#### 2 Factor

```{r}
# 2 factor: 

fa_result <- factanal(data_scaled, factors = 2, rotation = "varimax")

print(fa_result, cutoff=0.3, digits=3, sort=TRUE)



pca_result <- principal(data_scaled, nfactors=2, rotate="varimax")

print(pca_result$loadings, cutoff=0.35, digits=3, sort=TRUE)



# For correlation

model2 <- principal(data_scaled, nfactors = 2, rotate = 'promax')



# Correlation for promax

cor(model2$scores)
```


#### 3 Factor

```{r}
# 3 factor: 

fa_result <- factanal(data_scaled, factors = 3, rotation = "varimax")

print(fa_result, cutoff=0.3, digits=3, sort=TRUE)

pca_result <- principal(data_scaled, nfactors=3, rotate="varimax")

print(pca_result$loadings, cutoff=0.4, digits=3, sort=TRUE)



# For correlation

model2 <- principal(data_scaled, nfactors = 3, rotate = 'promax')

print(model2$loadings, cutoff=0.3, digits=3, sort=TRUE)



# Correlation for promax

cor(model2$scores)
```


#### 4 Factor

```{r}
# 4 factor: 



fa_result <- factanal(data_scaled, factors = 4, rotation = "varimax")

print(fa_result, cutoff=0.3, digits=3, sort=TRUE)



pca_result <- principal(data_scaled, nfactors=4, rotate="varimax")

print(pca_result$loadings, cutoff=0.4, digits=3, sort=TRUE)



# For correlation

model2 <- principal(data_scaled, nfactors = 4, rotate = 'promax')



# Correlation for promax

cor(model2$scores)
```


#### 5 Factor

```{r}
# 5 factor: 

fa_result <- factanal(data_scaled, factors = 5, rotation = "varimax")

print(fa_result, cutoff=0.3, digits=3, sort=TRUE)



pca_result <- principal(data_scaled, nfactors=5, rotate="varimax")

print(pca_result$loadings, cutoff=0.4, digits=3, sort=TRUE)



# For correlation

model2 <- principal(data_scaled, nfactors = 5, rotate = 'promax')



# Correlation for promax

cor(model2$scores)
```


#### Conduct VSS complexit and MAP tests

```{r}
# Conduct the MAP test via the VSS function

vss_result <- VSS(data_scaled, n = 8, rotate = "varimax", fm = "ml")



print(vss_result)



summary(vss_result)
```

```{r}
fa_result <- factanal(data_scaled[, -c(5)], factors = 3, rotation = "varimax")

print(fa_result, cutoff=0.3, digits=3, sort=TRUE)



pca_result <- principal(data_scaled[, -c(5)], nfactors=3, rotate="varimax")

print(pca_result$loadings, cutoff=0.4, digits=3, sort=TRUE)



# For correlation

model2 <- principal(data_scaled[, -c(5)], nfactors = 3, rotate = 'promax')



# Correlation for promax

cor(model2$scores)
```


Given the loadings from the principal component analysis (PCA) with both varimax and oblique (promax) rotations for three factors, and the low promax correlations suggesting independence among factors. Although a fourth factor was considered, it led to overfactoring, with two components being dominated by single variables, diminishing interpretability without significantly increasing cumulative variance explained.


##### Principal Component 1: Acoustic and Energy Dynamics

###### Variables:

Highly correlated with 'energy', 'loudness', 'acousticness' (negatively), and to a lesser extent, 'tempo' and 'instrumentalness'.



###### Description:

This component emphasizes the contrast between acoustic and electronic elements in music, capturing the dynamic range from soft, more natural sounds to energetic, amplified productions. It mirrors the balance between acoustic purity and the vibrancy of electronic music.



###### Business Implications:

For music producers and platforms, understanding this balance is crucial for curating content that appeals to diverse listener preferences, from acoustic serenity to high-energy beats. It can guide playlist curation for varying activities and moods, from relaxation to intense workouts.



##### Principal Component 2: Expressiveness and Live Experience

###### Variables:

Primarily associated with 'liveness' and 'speechiness', indicating tracks with live performance features and spoken word content.



###### Description:

This component distinguishes tracks with the authentic feel of live performances and spoken elements, potentially including live concerts, stand-up comedy, or spoken-word poetry, highlighting the human and immediate aspect of these recordings.



###### Business Implications:

This insight is invaluable for event organizers, streaming services, and radio programmers to design experiences that resonate with audiences seeking the genuine and unedited expressions of artists. It aids in promoting live event recordings and spoken word content to target demographics.



##### Principal Component 3: Rhythmic and Emotional Depth

###### Variables:

Tied to 'danceability', 'valence' (positivity), and negatively with 'duration_ms', suggesting a preference for shorter, upbeat, and emotionally positive tracks.



###### Description:

This component captures the essence of rhythm and mood in music, favoring tracks that are both danceable and emotionally uplifting. The negative association with 'duration_ms' suggests a lean towards more concise, impactful musical experiences.



###### Business Implications:

For marketers and playlist curators, this component underscores the importance of selecting tracks that boost listener mood and encourage movement, ideal for settings that aim to uplift or energize, such as parties, fitness classes, or retail spaces looking to enhance the shopping experience.



#### Conclusion:



For businesses, the nuanced understanding furnished by this model enables targeted strategic decisions in content curation, marketing, and customer experience. Streaming services, for instance, can refine recommendation algorithms with these insights, curating engaging and contextually resonant playlists. Venues and retailers, too, can utilize the emotional and energetic insights to craft ambient music experiences that align with customer moods and preferences, fostering an engaging atmosphere.



In sum, the adjusted three-factor model stands as a robust analytical framework for leveraging distinctive music characteristics. This approach not only enriches user experience but also underpins varied business applications, aiding in the strategic deployment of music to meet business objectives and enhance customer engagement.


## Clustering


#### View Principal Components Plots


Next I will view the plots of the principal components and see if I can identify any obvious shapes or clusters. This will guide my choice of clustering method to use.

```{r}
# Plot the first principal component against the second

plot(pca_result$scores[,1], pca_result$scores[,2],

     xlab="First Principal Component",

     ylab="Second Principal Component",

     main="PCA: Component 1 vs Component 2")



plot(pca_result$scores[,1], pca_result$scores[,3],

     xlab="First Principal Component",

     ylab="Third Principal Component",

     main="PCA: Component 1 vs Component 3")



plot(pca_result$scores[,2], pca_result$scores[,3],

     xlab="Second Principal Component",

     ylab="Third Principal Component",

     main="PCA: Component 2 vs Component 3")
```

```{r}
par(mar=c(8, 8, 8, 8) , cex.main=2, cex.lab=1.5, cex.axis=1.5)



mclust_result <- Mclust(data_scaled)



plot(mclust_result, what = "BIC")

summary(mclust_result)
```

```{r}
par(mar=c(8, 8, 8, 8) , cex.main=2, cex.lab=1.5, cex.axis=1.5)

plot(mclust_result, what = "classification")
```

```{r}
classification <- mclust_result$classification



cluster_means <- aggregate(data_scaled, by=list(cluster=classification), FUN=mean)

cluster_std <- aggregate(data_scaled, by=list(cluster=classification), FUN=sd)



cluster_means <- cluster_means[,-1]

cluster_std <- cluster_std[,-1]



print(round(cluster_means, 3))



print(round(cluster_std, 3))
```

```{r}
df$cluster <- mclust_result$classification



genre_frequency <- table(df$cluster, df$genre)



genre_frequency_df <- as.data.frame(genre_frequency)



colnames(genre_frequency_df) <- c("Cluster", "Genre", "Frequency")



top_genres_per_cluster <- genre_frequency_df %>%

  group_by(Cluster) %>%

  arrange(desc(Frequency)) %>%

  slice_head(n = 2) %>%

  ungroup()



print(top_genres_per_cluster)
```


##### Cluster 1: Subdued Acoustic

###### Top Genre: Folk

###### Attributes:

Moderate acousticness, danceability, and lower energy; quieter and less lively tracks.

###### Interpretation:

Tracks in this cluster are likely mellow, perhaps suitable for reflective or intimate settings.

###### Business Use:

Ideal for environments that require a calm and relaxing ambiance, like yoga studios or quiet cafes.



##### Cluster 2: Instrumental and Calm

###### Top Genre: Jazz

###### Attributes:

Average acousticness and instrumentalness, lower danceability, energy, and loudness.

###### Interpretation:

This cluster may contain calm instrumental or ambient tracks.

###### Business Use:

Great for spaces where a peaceful or contemplative atmosphere is desired, such as art galleries or libraries.



##### Cluster 3: Mellow and Melodic

###### Top Genre: Classical

###### Attributes:

Very high acousticness and instrumentalness, very low danceability, energy, and loudness.

###### Interpretation:

Likely includes slow, melodic tracks, possibly with orchestral or acoustic instruments.

###### Business Use:

Suitable for environments that benefit from serene background music, like massage parlors or meditation centers.



##### Cluster 4: Live and Energetic

###### Top Genre: Hip-Hop

###### Attributes:

Above-average liveness and speechiness, with moderate energy.

###### Interpretation:

Tracks may include live recordings or songs with significant lyrics or spoken components.

###### Business Use:

Perfect for live venues and social settings where a sense of energy and engagement is beneficial.



##### Cluster 5: Upbeat and Dynamic

###### Top Genre: Alternative

###### Attributes:

Low acousticness with higher energy and loudness, suggesting more dynamic tracks.

###### Interpretation:

Potentially includes a mix of pop, rock, or dance music that's more energetic and lively.

###### Business Use:

Versatile for various commercial settings, such as retail shops, bars, or parties to energize the crowd.



##### Cluster 6: Expressive and Intense

###### Top Genre: Comedy

###### Attributes:

Very high liveness and extremely high speechiness, with moderate energy.

###### Interpretation:

Could consist of tracks with prominent live and spoken word elements, indicating intense expression.

###### Business Use:

Suitable for events that focus on performance arts, spoken word, or other live expressions.



##### Cluster 7: Instrumental Focus

###### Top Genre: Electronic

###### Attributes:

Longer duration, high instrumentalness, and moderate liveness.

###### Interpretation:

Tracks might be longer instrumental pieces, perhaps with live performance elements.

###### Business Use:

Good for background ambiance where distraction should be minimal, like study spaces or bookstores.



##### Cluster 8: Calm and Melancholic

###### Top Genre: Opera

###### Attributes:

High acousticness, low danceability and energy, and very low loudness.

###### Interpretation:

May include genres like classical or soft indie, with melancholic or somber tones.

###### Business Use:

Fitting for spaces requiring subdued music, such as fine dining restaurants or quiet waiting areas.



##### Cluster 9: Popularity and Tempo

###### Top Genre: Hip-Hop

###### Attributes:

Lower acousticness, high danceability, and moderate tempo and loudness.

###### Interpretation:

Likely includes popular music genres that are catchy and designed for broad appeal.

###### Business Use:

Ideal for commercial environments aiming to create a mainstream appeal, like malls or casual dining.







Understanding these clusters allows businesses to tailor their music offerings to enhance the customer experience. By aligning the musical atmosphere with the brand's identity and the desired mood, businesses can influence customer behavior, dwell time, and even spending habits. For streaming services, these clusters could inform recommendation algorithms, helping to surface songs that align with listeners' current activities or mood, thereby increasing user engagement and satisfaction. For artists and record labels, insights from these clusters can guide marketing strategies and track selection for albums or playlists, targeting the right audience with the right music.

